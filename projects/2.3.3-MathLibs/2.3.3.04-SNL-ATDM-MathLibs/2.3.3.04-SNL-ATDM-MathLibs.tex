\subsubsection{\stid{3.04} ATDM SNL Math Libraries} \label{subsubsect:trilinos}

\paragraph{Overview} 
The major project outcome for the SNL ATM Math Libraries project is to provide re-usable and convenient, math-related tools for component-based software engineering of Exascale apps.

This project develops and integrates scalable, modular, and cross-cutting software infrastructure components for ATDM and other future Exascale applications that utilize, where appropriate, ATDM Core CS components: Kokkos performance portability, Sacado/ROL embedded sensitivity analysis and optimization technology, DARMA asynchronous many-tasking, and DataWarehouse.  These components include:
\begin{enumerate}
\item	KokkosKernels (KK):  performance-portable sparse/dense linear algebra and graph kernels that utilize the hierarchical memory subsystem expected in future architectures;
\item	Scalable Solvers (SS):  optimal linear solver algorithms that exploit fine-grain parallelism for vector/SIMT and thread scaling and leverage next-generation execution and communication capabilities;
\item	Agile Components (AC):  tools for interface abstractions, discretization, time integration, and solution of nonlinear PDEs; and 
\item Embedded Analysis (EA):  tools for enabling advanced analysis workflows, focusing on embedded sensitivity analysis and optimization with use of derivatives for uncertainty quantification.
\end{enumerate}

This project combines algorithmic R\&D with delivery of interoperable software components that are expected to be crucial capabilities that will enable Sandia's ATDM application codes to be performance portable across next-generation computing architectures such as GPUs and Xeon Phis.  This work will include integration of these components into the application codes and improving their design and interfaces for mission relevant use cases.	


\paragraph{Key  Challenges}
There are several challenges associated with the work this project is conducting. Part of the complexity arises because profiling tools are not yet full mature for advanced architectures and in this context profiling involves the interplay of several factors which require expert judgment to improve performance.  Another challenging aspect is working on milestones that span a variety of projects and code bases. There is a strong dependence on the various application code development teams for our own team's success. In addition, we face a constant tension between the need for production ready tools and components in a realm where the state-of-the-art is still evolving.

\paragraph{Solution Strategy}
To address the challenges above, the SNL ATM Math Libraries project is taking a staged approach to profiling in regards to target architectures and the algorithms involved. We are also coordinating on a regular basis with the other projects that are involved in our work to minimize impediments. In response to the need for production ready tools, we are focusing on a hierarchical approach that involves producing robust, hardened code for core algorithms while simultaneous pursuing research ideas where appropriate.

\paragraph{Recent Progress}
In this section we provide several high-level snapshots of recent progress in the Math Libraries project
\begin{itemize}
\item The SS team has recently achieved 10 solves/sec for the miniEM proxy application for EMPIRE, this is important for meeting the efficiency requirements to complete upcoming milestones.
\item The SS team is also making good progress in identifying other performance bottlenecks, such as over-decomposition. We now have performance date supporting hypotheses like these.
\item the AC team is working to promote CUDA aware GPU/GPU transfers in Tpetra.
\item the KK team made a recent presentation to Jim Peltz on the features of KK and recent progress.
\item The EA team has made progress in terms of addressing Stokhos issues that were holding up Kokkos promotion.
\item The AC team has made implemented a hierarchical parallelism approach to some of the kernels in Panzer leading to significant speedup.
\item the KK team finished work on SIMD with the University of Utah and submitted a paper on how to use SIMD in three cases.
\end{itemize}

\paragraph{Next Steps}
The following list details the next steps being taking by each component of the ATDM SNL Math Libraries project:

\begin{itemize}
\item The KK team is investigating using dynamic sizing for batched BLAS.
\item The SS team is continuing to investigate, in collaboration with the University of Wyoming, the use of Multilevel solvers, which will eventually get integrated into SPARC via MueLu.
\item The AC is continuing to work on the integration of Tempus into EMPIRE-PIC, including enabling higher order integration schemes.
\item The EA team is working on enabling transient full space optimization in SPARC.

\end{itemize}
